#!/bin/bash

set -e

export CONF_TYPE=debug
export CONF_BUILD_TYPE=Debug
export QT_PATH=${QT_PATH:-"$HOME/Qt"}
export QT_PREFIX_PATH="${QT_PATH}/5.15.2/clang_64"

rm -rf ${APROJECTS}/build-marble-${CONF_TYPE}
mkdir -p ${APROJECTS}/build-marble-${CONF_TYPE}

(
  cd ${APROJECTS}/build-marble-${CONF_TYPE}
  ${QT_PATH}/Tools/CMake/CMake.app/Contents/bin/cmake -DCMAKE_BUILD_TYPE=${CONF_BUILD_TYPE} -DBUILD_MARBLE_EXAMPLES=NO -DBUILD_INHIBIT_SCREENSAVER_PLUGIN=NO -DBUILD_MARBLE_APPS=NO -DBUILD_MARBLE_EXAMPLES=NO -DBUILD_MARBLE_TESTS=NO -DBUILD_MARBLE_TOOLS=NO -DBUILD_TESTING=NO -DBUILD_WITH_DBUS=NO -DMARBLE_EMPTY_MAPTHEME=YES -DMOBILE=NO -DWITH_DESIGNER_PLUGIN=NO -DWITH_Phonon=NO -DWITH_Qt5Location=NO -DWITH_Qt5Positioning=NO -DWITH_Qt5SerialPort=NO -DWITH_ZLIB=NO -DWITH_libgps=NO -DWITH_libshp=NO -DWITH_libwlocate=NO -DCMAKE_PREFIX_PATH=${QT_PREFIX_PATH} -DCMAKE_INSTALL_PREFIX=${APROJECTS}/Marble-${CONF_TYPE} -DEXEC_INSTALL_PREFIX=${APROJECTS}/Marble-${CONF_TYPE} ../marble/
  make -j4
  make install
)

bash copy_lib_mac_${CONF_TYPE}.sh
